<div class="book-session-shell">
  <app-sidebar class="sidebar-pane" (navigate)="router.navigate([$event])"></app-sidebar>
  <div class="book-session-container main-pane">
    <!-- Header -->
    <header class="page-header">
      <div class="container">
        <div class="header-content">
          <h1>Book a Session</h1>
          <div></div>
        </div>
      </div>
    </header>

  <!-- Filter Section -->
  <section class="filter-section">
    <div class="container">
      <div class="filter-card">
        <h2>Find Available Mentors</h2>
        <p>Select your preferred date and time to see available mentors</p>
        
        <form (ngSubmit)="searchMentors()" class="filter-form">
          <div class="filter-row">
            <div class="form-group">
              <label for="preferredDate">Preferred Date</label>
              <input
                type="date"
                id="preferredDate"
                [(ngModel)]="filters.preferredDate"
                name="preferredDate"
                required
                [min]="minDate"
                (change)="onDateChange()"
              />
            </div>

            <div class="form-group">
              <label for="preferredTime">Preferred Time</label>
              <select
                id="preferredTime"
                [(ngModel)]="filters.preferredTime"
                name="preferredTime"
                required
                (change)="onTimeChange()"
              >
                <option value="">Select time</option>
                <option value="09:00">9:00 AM</option>
                <option value="10:00">10:00 AM</option>
                <option value="11:00">11:00 AM</option>
                <option value="12:00">12:00 PM</option>
                <option value="13:00">1:00 PM</option>
                <option value="14:00">2:00 PM</option>
                <option value="15:00">3:00 PM</option>
                <option value="16:00">4:00 PM</option>
                <option value="17:00">5:00 PM</option>
              </select>
            </div>

            <div class="form-group">
              <label for="sessionDuration">Session Duration</label>
              <select
                id="sessionDuration"
                [(ngModel)]="filters.sessionDuration"
                name="sessionDuration"
                (change)="onDurationChange()"
              >
                <option value="30">30 minutes</option>
                <option value="60">60 minutes</option>
                <option value="90">90 minutes</option>
                <option value="120">120 minutes</option>
              </select>
            </div>

            <div class="form-group">
              <button type="submit" class="btn btn-primary search-btn" [disabled]="!filters.preferredDate || !filters.preferredTime || isSearching">
                <span *ngIf="!isSearching">üîç Search Mentors</span>
                <span *ngIf="isSearching">Searching...</span>
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </section>

  <!-- Results Section -->
  <section class="results-section" *ngIf="hasSearched">
    <div class="container">
      <div class="results-header">
        <h2>Available Mentors</h2>
        <p *ngIf="availableMentors.length > 0">
          Found {{ availableMentors.length }} mentor{{ availableMentors.length !== 1 ? 's' : '' }} available on {{ formatDate(filters.preferredDate) }} at {{ formatTime(filters.preferredTime) }}
        </p>
        <p *ngIf="availableMentors.length === 0 && !isSearching">
          No mentors available for the selected date and time. Try a different time slot.
        </p>
      </div>

      <!-- Loading State -->
      <div *ngIf="isSearching" class="loading-state">
        <div class="spinner"></div>
        <p>Searching for available mentors...</p>
      </div>

      <!-- Mentors Grid -->
      <div class="mentors-grid" *ngIf="!isSearching && availableMentors.length > 0">
        <div class="mentor-card" *ngFor="let mentor of availableMentors">
          <div class="mentor-header">
            <div class="mentor-avatar">
              <img [src]="getMentorAvatar(mentor.user.firstName, mentor.user.lastName)" [alt]="mentor.user.firstName" class="avatar-image">
            </div>
            <div class="mentor-info">
              <h3>{{ mentor.user.firstName }} {{ mentor.user.lastName }}</h3>
              <p class="mentor-position">{{ mentor.position }}</p>
              <p class="mentor-company">{{ mentor.company }}</p>
            </div>
            <div class="mentor-rating">
              <span class="rating">‚≠ê {{ mentor.rating | number:'1.1-1' }}</span>
              <span class="sessions">({{ mentor.totalSessions }} sessions)</span>
            </div>
          </div>

          <div class="mentor-body">
            <div class="expertise-section">
              <h4>Expertise</h4>
              <div class="expertise-tags">
                <span class="expertise-tag" *ngFor="let skill of mentor.expertise">{{ skill }}</span>
              </div>
            </div>

            <div class="bio-section">
              <p class="mentor-bio">{{ mentor.bio }}</p>
            </div>

            <div class="availability-info">
              <h4>Availability</h4>
              <p class="availability-text">
                Available on {{ getDayName(filters.preferredDate) }} from {{ formatTime(filters.preferredTime) }} 
                for {{ filters.sessionDuration }} minutes
              </p>
            </div>
          </div>

          <div class="mentor-footer">
            <div class="pricing-info">
              <span class="hourly-rate">${{ mentor.hourlyRate }}/hour</span>
              <span class="session-cost">Total: ${{ getSessionCost(mentor.hourlyRate) }}</span>
            </div>
            <button class="btn btn-primary book-btn" (click)="bookSession(mentor)">
              Book Session
            </button>
          </div>
        </div>
      </div>

      <!-- No Results -->
      <div class="no-results" *ngIf="!isSearching && availableMentors.length === 0">
        <div class="no-results-icon">üìÖ</div>
        <h3>No mentors available</h3>
        <p>No mentors are available for the selected date and time. Try:</p>
        <ul>
          <li>Selecting a different time slot</li>
          <li>Choosing a different date</li>
          <li>Adjusting the session duration</li>
        </ul>
        <button class="btn btn-outline" (click)="clearFilters()">Try Different Time</button>
      </div>
    </div>
  </section>
  </div>
</div>
